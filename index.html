<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MarkMirror Mobile - Markdown Editor</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="–ú–æ—â–Ω—ã–π Markdown-—Ä–µ–¥–∞–∫—Ç–æ—Ä —Å –¥–≤—É—Ö–ø–∞–Ω–µ–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ –∂–∏–≤—ã–º –ø—Ä–µ–≤—å—é">
    <meta name="keywords" content="markdown, editor, preview, pwa, mobile, text, writing">
    <meta name="author" content="MarkMirror Team">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Theme Colors -->
    <meta name="theme-color" content="#007bff">
    <meta name="msapplication-TileColor" content="#007bff">
    <meta name="msapplication-navbutton-color" content="#007bff">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="72x72" href="src/img/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="96x96" href="src/img/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="128x128" href="src/img/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="144x144" href="src/img/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="src/img/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="192x192" href="src/img/icon-192x192.png">
    <link rel="apple-touch-icon" sizes="384x384" href="src/img/icon-384x384.png">
    <link rel="apple-touch-icon" sizes="512x512" href="src/img/icon-512x512.png">

    <!-- Standard Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="src/img/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="src/img/icon-16x16.png">
    <link rel="shortcut icon" href="src/img/favicon-old.ico">

    <!-- Apple Web App -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="MarkMirror">

    <!-- Microsoft Tiles -->
    <meta name="msapplication-TileImage" content="src/img/icon-144x144.png">
    <meta name="msapplication-config" content="browserconfig.xml">

    <!-- External Libraries -->
    <!-- CodeMirror 6 - Using importmap for better module resolution -->
    <script type="importmap">
    {
        "imports": {
            "@codemirror/state": "https://cdn.skypack.dev/@codemirror/state",
            "@codemirror/view": "https://cdn.skypack.dev/@codemirror/view",
            "@codemirror/basic-setup": "https://cdn.skypack.dev/@codemirror/basic-setup",
            "@codemirror/lang-markdown": "https://cdn.skypack.dev/@codemirror/lang-markdown",
            "@codemirror/theme-one-dark": "https://cdn.skypack.dev/@codemirror/theme-one-dark",
            "@codemirror/autocomplete": "https://cdn.skypack.dev/@codemirror/autocomplete"
        }
    }
    </script>

    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- DOMPurify for HTML sanitization -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>

    <!-- Marked.js for comparison (optional) -->
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="src/style/index.css">
</head>
<body>
    <!-- Main Container -->
    <div id="app" class="app">
        <!-- Header with controls -->
        <header class="header">
            <div class="header-left">
                <h1 class="app-title">MarkMirror Mobile</h1>
                <div class="file-controls">
                    <input type="file" id="import-file" accept=".md,.txt" style="display: none;">
                    <button id="import-btn" class="btn btn-secondary" title="–ò–º–ø–æ—Ä—Ç .md —Ñ–∞–π–ª–∞">
                        üìÅ –ò–º–ø–æ—Ä—Ç
                    </button>
                    <button id="export-md-btn" class="btn btn-secondary" title="–≠–∫—Å–ø–æ—Ä—Ç –≤ .md">
                        üíæ .md
                    </button>
                    <button id="export-html-btn" class="btn btn-secondary" title="–≠–∫—Å–ø–æ—Ä—Ç –≤ .html">
                        üåê .html
                    </button>
                    <button id="clear-btn" class="btn btn-danger" title="–û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>
            </div>

            <div class="header-right">
                <div class="controls">
                    <!-- Theme toggle -->
                    <button id="theme-toggle" class="btn btn-icon" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        üåô
                    </button>

                    <!-- Settings toggle -->
                    <button id="settings-toggle" class="btn btn-icon" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
                        ‚öôÔ∏è
                    </button>

                    <!-- Analytics toggle -->
                    <button id="analytics-toggle" class="btn btn-icon" title="–ê–Ω–∞–ª–∏—Ç–∏–∫–∞">
                        üìä
                    </button>

                    <!-- Help toggle -->
                    <button id="help-toggle" class="btn btn-icon" title="–°–ø—Ä–∞–≤–∫–∞">
                        ‚ùì
                    </button>
                </div>
            </div>
        </header>

        <!-- Settings Panel -->
        <div id="settings-panel" class="settings-panel hidden">
            <div class="settings-content">
                <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>

                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="auto-complete-toggle" checked>
                        –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ Markdown
                    </label>
                </div>

                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="sync-scroll-toggle">
                        –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
                    </label>
                </div>

                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="use-external-parser-toggle">
                        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π –ø–∞—Ä—Å–µ—Ä (Marked.js)
                    </label>
                </div>

                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="embed-styles-toggle" checked>
                        –í—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å—Ç–∏–ª–∏ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ HTML
                    </label>
                </div>

                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="markdown-highlight-toggle" checked>
                        –ü–æ–¥—Å–≤–µ—Ç–∫–∞ Markdown –≤ Plain Text
                    </label>
                </div>

                <div class="setting-group">
                    <label for="preview-zoom">–ú–∞—Å—à—Ç–∞–± –ø—Ä–µ–≤—å—é:</label>
                    <input type="range" id="preview-zoom" min="50" max="200" value="100" step="25">
                    <span id="zoom-value">100%</span>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Mobile Tab Navigation (visible on small screens) -->
            <div class="mobile-tabs">
                <button class="tab-btn active" data-tab="editor">–†–µ–¥–∞–∫—Ç–æ—Ä</button>
                <button class="tab-btn" data-tab="preview">–ü—Ä–µ–≤—å—é</button>
            </div>

            <!-- Editor Panel -->
            <div class="editor-panel panel">
                <div class="panel-header">
                    <h3>Markdown –†–µ–¥–∞–∫—Ç–æ—Ä</h3>
                    <div class="panel-controls">
                        <span id="char-count" class="char-count">0 —Å–∏–º–≤–æ–ª–æ–≤</span>
                    </div>
                </div>
                <div id="editor-container" class="editor-container"></div>
            </div>

            <!-- Preview Panel -->
            <div class="preview-panel panel">
                <div class="panel-header">
                    <h3>–ü—Ä–µ–≤—å—é</h3>
                    <div class="panel-controls">
                        <button id="preview-mode-toggle" class="btn btn-small" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –ø—Ä–µ–≤—å—é">
                            üì± –ú–æ–±–∏–ª—å–Ω—ã–π –≤–∏–¥
                        </button>
                    </div>
                </div>

                <!-- Preview Content -->
                <div class="preview-content">
                    <!-- Plain Text Preview (Top) -->
                    <div class="preview-section plain-text-preview">
                        <div class="preview-section-header">
                            <h4>üìù Plain Text + –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                        </div>
                        <div id="plain-text-output" class="preview-output"></div>
                    </div>

                    <!-- HTML Preview (Bottom) -->
                    <div class="preview-section html-preview">
                        <div class="preview-section-header">
                            <h4>HTML –†–µ–Ω–¥–µ—Ä</h4>
                        </div>
                        <div id="html-output" class="preview-output markdown-body"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Help Modal -->
        <div id="help-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–°–ø—Ä–∞–≤–∫–∞ –ø–æ Markdown</h3>
                    <button id="close-help" class="btn btn-icon">‚úï</button>
                </div>
                <div class="modal-body">
                    <div id="help-content" class="help-content">
                        <!-- Help content will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading indicator -->
        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="src/script/index.js"></script>
</body>
</html>